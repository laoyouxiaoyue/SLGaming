{
  "swagger": "2.0",
  "info": {
    "title": "验证码服务 API",
    "description": "验证码相关的接口文档，用于发送短信验证码",
    "version": "1.0.0",
    "termsOfService": "",
    "contact": {
      "name": "SLGaming",
      "url": "",
      "email": ""
    },
    "license": {
      "name": "Apache-2.0",
      "url": "https://www.apache.org/licenses/LICENSE-2.0.html"
    }
  },
  "host": "localhost:8888",
  "basePath": "/api",
  "schemes": ["http", "https"],
  "consumes": ["application/json"],
  "produces": ["application/json"],
  "tags": [
    {
      "name": "验证码",
      "description": "验证码相关接口"
    }
  ],
  {
    "name": "用户",
    "description": "用户注册/登录/重置密码相关接口"
  },
  "securityDefinitions": {
    "ApiKeyAuth": {
      "type": "apiKey",
      "name": "Authorization",
      "in": "header",
      "description": "可选的 Bearer token，格式：Bearer <token>"
    }
  },
  "paths": {
    "/code/send": {
      "post": {
        "tags": ["验证码"],
        "summary": "发送验证码",
        "description": "向指定手机号发送验证码短信，支持多种用途（注册、登录、验证、重置密码）",
        "operationId": "sendCode",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/SendCodeRequest"
            }
          }
        ],
        "security": [],
        "responses": {
          "200": {
            "description": "发送成功",
            "schema": {
              "$ref": "#/definitions/SendCodeResponse"
            },
            "examples": {
              "application/json": {
                "code": 0,
                "msg": "验证码发送成功",
                "data": {
                  "success": true
                }
              }
            }
          },
          "400": {
            "description": "请求参数错误",
            "schema": {
              "$ref": "#/definitions/BaseResp"
            },
            "examples": {
              "application/json": {
                "code": 400,
                "msg": "手机号格式错误"
              }
            }
          },
          "429": {
            "description": "发送过于频繁",
            "schema": {
              "$ref": "#/definitions/BaseResp"
            },
            "examples": {
              "application/json": {
                "code": 429,
                "msg": "手机号发送过于频繁，请 60 秒后再试"
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "schema": {
              "$ref": "#/definitions/BaseResp"
            },
            "examples": {
              "application/json": {
                "code": 500,
                "msg": "验证码发送失败，请稍后重试"
              }
            }
          }
        }
      }
    }
    ,
    "/user/register": {
      "post": {
        "tags": ["用户"],
        "summary": "用户注册",
        "description": "通过手机号/密码和验证码注册新用户",
        "operationId": "registerUser",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {"$ref": "#/definitions/RegisterRequest"}
          }
        ],
        "responses": {
          "200": {
            "description": "注册成功",
            "schema": {"$ref": "#/definitions/RegisterResponse"},
            "examples": {
              "application/json": {"code": 0, "msg": "注册成功", "data": {"userId": "12345"}}
            }
          },
          "400": {
            "description": "参数错误",
            "schema": {"$ref": "#/definitions/BaseResp"},
            "examples": {"application/json": {"code": 400, "msg": "验证码错误或参数缺失"}}
          },
          "409": {
            "description": "用户已存在",
            "schema": {"$ref": "#/definitions/BaseResp"},
            "examples": {"application/json": {"code": 409, "msg": "手机号已被注册"}}
          },
          "500": {
            "description": "服务器错误",
            "schema": {"$ref": "#/definitions/BaseResp"},
            "examples": {"application/json": {"code": 500, "msg": "注册失败，请稍后重试"}}
          }
        }
      }
    },
    "/user/login": {
      "post": {
        "tags": ["用户"],
        "summary": "用户登录",
        "description": "手机号+密码登录，返回访问 Token",
        "operationId": "loginUser",
        "parameters": [
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/LoginRequest"}}
        ],
        "responses": {
          "200": {
            "description": "登录成功",
            "schema": {"$ref": "#/definitions/LoginResponse"},
            "examples": {"application/json": {"code": 0, "msg": "登录成功", "data": {"accessToken": "ey...", "refreshToken": "rt...", "expiresIn": 3600}}}
          },
          "400": {
            "description": "参数错误",
            "schema": {"$ref": "#/definitions/BaseResp"},
            "examples": {"application/json": {"code": 400, "msg": "参数格式错误"}}
          },
          "401": {
            "description": "认证失败",
            "schema": {"$ref": "#/definitions/BaseResp"},
            "examples": {"application/json": {"code": 401, "msg": "手机号或密码错误"}}
          },
          "500": {
            "description": "服务器错误",
            "schema": {"$ref": "#/definitions/BaseResp"},
            "examples": {"application/json": {"code": 500, "msg": "登录失败，请稍后重试"}}
          }
        }
      }
    },
    "/user/forgetPassword": {
      "post": {
        "tags": ["用户"],
        "summary": "重置密码（忘记密码）",
        "description": "使用手机号+验证码重置密码",
        "operationId": "resetPassword",
        "parameters": [
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/ResetPasswordRequest"}}
        ],
        "responses": {
          "200": {
            "description": "重置成功",
            "schema": {"$ref": "#/definitions/ResetPasswordResponse"},
            "examples": {"application/json": {"code": 0, "msg": "密码重置成功", "data": {"success": true}}}
          },
          "400": {
            "description": "参数或验证码错误",
            "schema": {"$ref": "#/definitions/BaseResp"},
            "examples": {"application/json": {"code": 400, "msg": "验证码无效或参数错误"}}
          },
          "404": {
            "description": "用户未找到",
            "schema": {"$ref": "#/definitions/BaseResp"},
            "examples": {"application/json": {"code": 404, "msg": "未找到对应用户"}}
          },
          "500": {
            "description": "服务器错误",
            "schema": {"$ref": "#/definitions/BaseResp"},
            "examples": {"application/json": {"code": 500, "msg": "重置失败，请稍后重试"}}
          }
        }
      }
    }
  },
  "definitions": {
    "BaseResp": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32",
          "description": "响应码，0表示成功"
        },
        "msg": {
          "type": "string",
          "description": "响应消息"
        }
      },
      "required": ["code", "msg"]
    },
    "SendCodeRequest": {
      "type": "object",
      "required": ["phone", "purpose"],
      "properties": {
        "phone": {
          "type": "string",
          "description": "手机号",
          "example": "13800138000"
        },
        "purpose": {
          "type": "string",
          "description": "验证码用途：verification（验证）、login（登录）、register（注册）、resetpassword（重置密码）",
          "enum": ["verification", "login", "register", "resetpassword"],
          "example": "register"
        }
      },
      "example": {
        "phone": "13800138000",
        "purpose": "register"
      }
    },
    "SendCodeData": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean",
          "description": "是否发送成功",
          "example": true
        }
      }
    },
    "SendCodeResponse": {
      "type": "object",
      "allOf": [
        {
          "$ref": "#/definitions/BaseResp"
        },
        {
          "type": "object",
          "properties": {
            "data": {
              "$ref": "#/definitions/SendCodeData"
            }
          }
        }
      ]
    }
    ,
    "RegisterRequest": {
      "type": "object",
      "required": ["phone", "password", "code"],
      "properties": {
        "phone": {"type": "string", "example": "13800138000"},
        "password": {"type": "string", "example": "P@ssw0rd"},
        "code": {"type": "string", "description": "短信验证码", "example": "123456"}
      }
    },
    "RegisterData": {
      "type": "object",
      "properties": {"userId": {"type": "string", "example": "12345"}}
    },
    "RegisterResponse": {
      "type": "object",
      "allOf": [{"$ref": "#/definitions/BaseResp"}, {"type": "object", "properties": {"data": {"$ref": "#/definitions/RegisterData"}}}]
    },
    "LoginRequest": {
      "type": "object",
      "required": ["phone", "password"],
      "properties": {
        "phone": {"type": "string", "example": "13800138000"},
        "password": {"type": "string", "example": "P@ssw0rd"}
      }
    },
    "LoginData": {
      "type": "object",
      "properties": {
        "accessToken": {"type": "string"},
        "refreshToken": {"type": "string"},
        "expiresIn": {"type": "integer", "format": "int32"}
      }
    },
    "LoginResponse": {
      "type": "object",
      "allOf": [{"$ref": "#/definitions/BaseResp"}, {"type": "object", "properties": {"data": {"$ref": "#/definitions/LoginData"}}}]
    },
    "ResetPasswordRequest": {
      "type": "object",
      "required": ["phone", "newPassword", "code"],
      "properties": {
        "phone": {"type": "string", "example": "13800138000"},
        "newPassword": {"type": "string", "example": "NewP@ssw0rd"},
        "code": {"type": "string", "description": "短信验证码", "example": "123456"}
      }
    },
    "ResetPasswordData": {
      "type": "object",
      "properties": {"success": {"type": "boolean", "example": true}}
    },
    "ResetPasswordResponse": {
      "type": "object",
      "allOf": [{"$ref": "#/definitions/BaseResp"}, {"type": "object", "properties": {"data": {"$ref": "#/definitions/ResetPasswordData"}}}]
    }
  }
}

